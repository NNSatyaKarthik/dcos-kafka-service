{
  "id": "{{kafka.framework-name}}",
  "cpus": {{kafka.app.cpus}},
  "mem": {{kafka.app.mem}},
  "instances": {{kafka.app.instances}},
  "cmd": "export PATH=$PATH:$MESOS_SANDBOX/jre/bin && java -Xmx{{kafka.app.heap-mb}}m -jar kafka-scheduler*.jar",
  "env": {
    "LD_LIBRARY_PATH": "{{kafka.ld-library-path}}",
    "FRAMEWORK_NAME": "{{kafka.framework-name}}",
    "ROLE": "{{kafka.framework-role}}",
    "PRINCIPAL": "{{kafka.framework-principal}}",
    "USER": "{{kafka.user}}",
    "PLACEMENT_STRATEGY": "{{kafka.placement-strategy}}",
    "BROKER_COUNT": "{{kafka.broker-count}}",
    "BROKER_CPUS": "{{kafka.cpus}}",
    "BROKER_MEM": "{{kafka.mem}}",
    "BROKER_DISK": "{{kafka.disk}}",
    "BROKER_PV": "{{kafka.pv}}",
    "BROKER_DELETE_TOPIC_ENABLE": "{{kafka.broker-delete-topic-enable}}",
    "ZOOKEEPER_ADDR": "{{kafka.zookeeper-addr}}",
    "KAFKA_VER_NAME": "{{kafka.version_name}}",
    "KAFKA_URI": "{{resource.assets.uris.kafka_2-10-0-9-0-0-tgz}}",
    "KAFKA_BIN_PATH": "kafka_2.10-0.9.0.0/bin",
    "CONTAINER_HOOK_URI": "{{resource.assets.uris.container-hook-0-1-0-tgz}}",
    "JAVA_URI": "{{resource.assets.uris.jre-8u72-linux-x64-tar-gz}}"
  },
  "uris": [
    "{{resource.assets.uris.jre-8u72-linux-x64-tar-gz}}",
    "{{resource.assets.uris.kafka-scheduler-0-1-0-jar}}",
    "{{resource.assets.uris.kafka_2-10-0-9-0-0-tgz}}"
  ],
  "healthChecks": [
    {
      "protocol": "COMMAND",
      "command": { "value": "export PATH=$PATH:$MESOS_SANDBOX/jre/bin && ./kafka_2.10-0.9.0.0/bin/kafka-topics.sh --zookeeper master.mesos:2181/{{kafka.framework-name}} --describe --under-replicated-partitions | wc -l | { read count; echo Under replicated partition count = $count; exit $count; }" },
      "gracePeriodSeconds": 300,
      "intervalSeconds": 60,
      "timeoutSeconds": 60,
      "maxConsecutiveFailures": 3
    }
  ],
  "ports": [0]
}
